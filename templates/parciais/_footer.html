{% load static %}

<div id="footer" class="container-fluid bg-dark p-4">
    <div class="container text-center">
        <p class="mb-0 text-white w-100">Em caso de problemas com a ferramenta, entre em contato com Liniker Oliveira ou Pedro Melo / RH - Salto</p>
    </div>
</div>



    <script src="{% static 'assets\jquery\jquery-3.4.1.slim.min.js' %}"></script>
    <script src="{% static 'assets\jquery\popper.min.js' %}"></script>
    <script src="{% static 'assets\bootstrap\bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'assets\jquery\jquery-3.2.1.min.js' %}"></script>
    <script>window.jQuery || document.write('<script src="{% static "assets/jquery/jquery.slim.min.js" %}"><\/script>')</script>
    <script src="{% static 'assets\bootstrap\bootstrap.bundle.min.js' %}"></script>
   
    <script>
    var message_ele = document.getElementById("message_container");

      setTimeout(function(){ 
        message_ele.style.display = "none"; 
        }, 7000);
    </script>

    <script>
      jQuery('#id_unidade option:selected').text(" ");
    </script>

    <script>
      jQuery(function () {
        var path = window.location.pathname.substring(-1);
        console.log("path : ", path)
        page = window.location.href.split("/").pop()
        console.log("caminho : ", page)
        if (page = path) {
          jQuery('li>a[href="' + path + '"]').addClass('active');
        }
      });
    </script>

    <script>
      jQuery(document).on('click', 'ul li', function(){
        jQuery(this).addClass('active')
      })
      
    </script>

      <script charset="UTF-8">
        jQuery("#id_funcionario").change(function () {
          let re_func = jQuery(this).val();
          let url = "/pegar_funcionario/" + re_func + "/";
          jQuery.ajax({
            url: url,
            type: 'GET',
            data: {
              re_func: re_func
            },
            beforeSend: function (xhr) {
              // body...
            },
            success: function (response) {
              jQuery("#id_nome").val(response.nome);
              jQuery("#email").val(response.email)
              // console.log(response.nome);
              // console.log(response.email);
            },
            error: function (xhr) {
              // body... xhr.statusText + xhr.responseText
            },
            complete: function () {
              // body...
            }
          })
        });
      </script>



  <script>
    function indexMatchingText(ele, text) {
        for (var i = 0; i < ele.length; i++) {
          if (ele[i].childNodes[0].nodeValue === text) {
            return i;
          }
        }
        return undefined;
      }


    jQuery("#id_categoria").change(function () {
      let categoria = jQuery(this).children("option:selected").val();
      var select = document.getElementById('id_categoria').getElementsByTagName("option");
      categoria = indexMatchingText(select, categoria)
      let url = "carregar_subcategorias/" + categoria + "/";
      console.log(categoria)

      jQuery.ajax({                      
        url: url,                    
        type: 'GET',
        data: {
          'categoria': categoria       
        },
        success: function (response) {
          jQuery('#subcategoria').empty();
          let object = JSON.parse(response.data)
          object.forEach( function (data)  {
            console.log()
              $('<option/>', {
                'value': data.pk,
                'text': data.fields.nome,
              }).appendTo("#subcategoria")
          });   
          
        }
      });

    });
  </script>

  <script>
     jQuery("#unidade").change(function () {
        let unidade = jQuery(this).val();
        let url = "/carregar_unidade/" + unidade + "/";
        jQuery.ajax({
          url: url,
          type: 'GET',
          data: {
            unidade: unidade
          },
          beforeSend: function (xhr) {
            // body...
          },
          success: function (data) {
          concatenar = jQuery("#concatenar").val(unidade) 
          },
          error: function (xhr) {
            // body... xhr.statusText + xhr.responseText
          },
          complete: function () {
            // body...
          }
        })
      });

  </script>
